{"hash":"890a5bb177aa437ce810a1c6431a6c48c6a43266","data":{"doc":{"title":"üõ°Ô∏è Secure transports","path":"/transports/","date":"14. March 2021","timeToRead":6,"content":"<h2 id=\"tor-onion\"><a href=\"#tor-onion\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Tor Onion</h2>\n<p>Tor anonymity network. For secure remote access using onion services and (optionally) for proxying bitcoind.</p>\n<p>Onion services provide strong encryption and mutual authentication established based on information embedded into the <code class=\"language-text\">.onion</code> hostname. It does not require setting up port forwarding.</p>\n<p>The onion service files, including secret key material, will be kept in <code class=\"language-text\">/data/tor-hsv</code>. If you lose them you'll lose your <code class=\"language-text\">.onion</code> address.</p>\n<h4 id=\"setting-up\"><a href=\"#setting-up\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Setting up</h4>\n<p>Start with <code class=\"language-text\">TOR=1</code>. The <code class=\"language-text\">.onion</code> hostname will be shown on startup.</p>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1508 176' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-b00742493f19c1c9677d28e877d08640'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-b00742493f19c1c9677d28e877d08640)' width='1508' height='176' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAHCAYAAAC4NEsKAAAACXBIWXMAAC4jAAAuIwF4pT92AAADc0lEQVQ4y31U6W7TYBDsIwCp7bY5nKOO7fiO7yMJaUsFgvd/nWVmLUeAKn58%2bq49Z2f3zrAssZZYC0t4ni9XuqzHJ11Pi6U8zhfjvlj89Taexz%2be%2bTauucryPDNMuTet2zKsh//e/138/0hnevto/0jnI38831lLU5x%2bJpv8XownQ%2bqul7bvxF6vZfP8LP1pkCQ7SpqlkhWlZMejHKJIDmEojuvJscglL0vZe66keY57IXGaSpQk%2brdY2TeAzIdHdcz94Wl%2bu09gM6DpPP0bfyQ16U1JUI473/4Gwbr9swj8n/z/C9CdObdkW8zEjg0xHg0pqlqavhV7swEAjpRVKQmSDuMIAOSanHs4SHrMJK8q8Q6%2bJlnUlTRdp7Kny/kGRNW2UreNhAkAzPH39SL9MMj19UWOZaF6EeSarlUd7j7ATbJEyqZBQVrpzyepmlpK2KJfFqWsa/gvEW%2blPivIMsYozdROArkwjuXHr58yQD9KYlmtN/Lpy0w%2bz4w/GADq76qZrJN7BSAHAHS2tG3Z7V3p4Ix31/c1eCbsBQECHBnhBwdtGSbDIPaep44ZvCYFdjQAgOyI00QBKRB4jgQiBNwNHUCo5fr2Ap16BC7LYKvCfQSPb7RJ%2bzy3Q6/JV/ijDsGoVC7X%2bAk0/TO2GOwlG/nGfF7eXhWQzXar7XlnAoAtALCTkQF5WavRFQBwPF9qnD1UnACwUgmCY2UDtEEK5BdI3gtCCXHPkOTOcTQBJtmglRhIWZcKEANp%2bl7biFWjHKtLYIfzoP/UI1glmEF2sOJ%2bGCngBI/v1KEvgpNq9WsFkbo1WDiB5SNuytHPIQxU//37u7LBnFpAGdCAAdnIgKYfQOGTrIHQ1tmjQr32OB0TCN6JtiaICjPhPcDh/%2blykS3mBluj6Ub6kgFv729aJSbRn88qy2BygHK5foXNATLfVJ5JEZwzQGnxXkCG9nJUl0BxPrHFqEtZ2rm%2bXhWIAXETcALCNgmiUO9kC9mX5oV8gx8CzTg5E3QGrCJDFq4pxoOJARer8Hy5lPlqpc5paBx6rtgAhhUiA2iIshwyDqjP%2bzNkds4zen4cgqyeOkeABDBAddir7iEAq7xbhVhtDldWz1dGhdrPrBb90u7oL721BNm4B0upT4ozxhR/LmJhjC4GM9lJvxHk7e1OGRXpkI4VgN9c45sdNa7t9gAAAABJRU5ErkJggg==' /%3e%3c/svg%3e\" width=\"1508\" data-srcset=\"/assets/static/tor.82a2fbd.273880f825d780422ecc602ee85e3e02.png 480w, /assets/static/tor.cbab2cf.273880f825d780422ecc602ee85e3e02.png 1024w, /assets/static/tor.e559bac.273880f825d780422ecc602ee85e3e02.png 1508w\" data-sizes=\"(max-width: 1508px) 100vw, 1508px\" data-src=\"/assets/static/tor.e559bac.273880f825d780422ecc602ee85e3e02.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/tor.e559bac.273880f825d780422ecc602ee85e3e02.png\" width=\"1508\"></noscript></p>\n<p>You'll be able to access your server through the <code class=\"language-text\">.onion</code> address from any client device with Tor installed, like the <a href=\"https://www.torproject.org/download/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Tor Browser</a> for desktop or <a href=\"https://play.google.com/store/apps/details?id=org.torproject.android\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Orbot</a> for Android.</p>\n<h4 id=\"non-anonymous-mode\"><a href=\"#non-anonymous-mode\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Non-anonymous mode</h4>\n<p>You can set <code class=\"language-text\">TOR_NONANONYMOUS=1</code> to use the <a href=\"https://2019.www.torproject.org/docs/tor-manual.html.en#HiddenServiceSingleHopMode\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">single-hop non-anonymous mode</a>. This will remove the 3 extra hops that protect the server's anonymity, making the connection faster and more reliable. Clients will remain anonymous. Note that this is <a href=\"https://gitlab.torproject.org/legacy/trac/-/issues/21284\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">incompatible</a> with <code class=\"language-text\">BITCOIND_TOR</code>.</p>\n<h4 id=\"options\"><a href=\"#options\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Options</h4>\n<ul>\n<li><code class=\"language-text\">TOR=0</code> (disabled by default, set to <code class=\"language-text\">1</code> to enable)</li>\n<li><code class=\"language-text\">TOR_NONANONYMOUS=0</code> (enable non-anonymous mode)</li>\n<li><code class=\"language-text\">TOR_CONFIG=&lt;none&gt;</code> (custom config to append to <code class=\"language-text\">torrc</code>)</li>\n<li><code class=\"language-text\">TOR_LOGS=0</code> (display tor's logs in the <code class=\"language-text\">docker run</code> output)</li>\n<li><code class=\"language-text\">BITCOIND_TOR=0</code> (connect to the bitcoin network through tor)</li>\n<li><code class=\"language-text\">BITCOIND_RPC_ONION=0</code> (expose the bitcoind rpc port over onion)</li>\n</ul>\n<h4 id=\"paths\"><a href=\"#paths\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Paths</h4>\n<ul>\n<li><code class=\"language-text\">/data/tor-hsv</code> (onion service files)</li>\n</ul>\n<h2 id=\"dropbear-ssh\"><a href=\"#dropbear-ssh\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Dropbear SSH</h2>\n<p>Lightweight SSH server powered by <a href=\"https://matt.ucc.asn.au/dropbear/dropbear.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Dropbear</a>. For secure remote access via SSH tunnels, using public-key based authentication.</p>\n<p>A pair of client and server keys will be generated for you by default. The client's private key that can be used to login will be available in <code class=\"language-text\">/data/ssh-keys/client_rsa</code>.</p>\n<p>If you already have a client key that you'd like to use, you can mount the pubkey file into <code class=\"language-text\">/root/id.pub</code> (e.g. <code class=\"language-text\">-v ~/.ssh/id_rsa.pub:/root/id.pub</code>), or mount an <code class=\"language-text\">authorized_keys</code> file into <code class=\"language-text\">/root/.ssh/authorized_keys</code>.</p>\n<p>By default, the SSH server permits port tunneling only. Set <code class=\"language-text\">SSHD=UNRESTRICTED</code> to enable shell access, X11 forwarding, agent forwarding and remote port forwarding.</p>\n<h4 id=\"server-set-up\"><a href=\"#server-set-up\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Server set-up</h4>\n<p>Enable <code class=\"language-text\">SSHD</code>, publish the SSH port (2222) for remote access and give the container an hostname (to make its virtual IP address easily discoverable from the client).</p>\n<pre class=\"language-bash\"><span class=\"token punctuation\">(</span>server<span class=\"token punctuation\">)</span>$ docker run -p <span class=\"token number\">2222</span>:2222 --hostname ez -it <span class=\"token punctuation\">..</span>. eznode/eznode <span class=\"token assign-left variable\">SSHD</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1358 211' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-4fdd92037010b68dade3088700d9a4dc'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-4fdd92037010b68dade3088700d9a4dc)' width='1358' height='211' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAKCAYAAAAEqljUAAAACXBIWXMAAC4jAAAuIwF4pT92AAAFZklEQVRIx41W2ZbiOAytT%2bgiK1tWspAFyEZCoKCgp6b7TJ/5/8%2b5c2Wgq96mH3xsS7IjXV3JeTGmFpxSh5MbMBcG5gsH27pGuSlhz%2bZw/ABZWSJZrxElqZqTLFPrpechp06GF4RY57mSu76PlDZ%2bGMLxfMRpCot3FZsNco4oSeCvVjxXIOD8vFfsU94h98h%2bOp8jiCJlr5sWNA6ZDcv%2b3/Gndi8mAQh6DeFeh%2blodH6F68cHxuMBS9dFTEfGtxP2w4CqaVC3LXZ1hf3hgDWDHMYRb5czA4lwOI4ot1sVcNf3HHsVqMhWDELOdrynH3ola6nPigLNvlNn5f5yu1F3V7SN4hjFw86ezgjIAhbnPwnsT8eLOSMAew1BKwCQCV6At%2bs7hkOP%2bXKJVZzQoQFN1ymnq7Z5zC1SgiPynnrJdFbkKHc7HAiYH/gq2%2bPpyHsc7JoaC8dRbDpfLwSxVsFtaL%2btdkrejwcFRpoJy3LqNkqWcC/J6Al2uk7xbaKRDSYmuoFXTcfEMKAZplrL/Fwrndjon/rXia7OTzRDseTOgO4BwFKH64W43G4MqleOr0jPgU5INltmNaEDxXbHrF8UNYUNTdfCC1eKCZvdFlGaKXDqBzhLgiOz6Jauj5ZBvt%2buOBAcuUeA2x9GdN2Arh2Q5RuyYY8fP3/h4%2bMHk/GGuunRtnsy88zv9dhua9RVy/NXvF9vuFxuOPGuPdl1vl4VwOL3x4%2b/8c%2b/vxR48s0zk/v2flGsCqP4wQCWQNDpsIQBboizODcOKmPRAwCpyTQvVBCylj4hNSwfknqPSPuKWZaM%2biwHYUJDtsTpWpWE7CVw6QNyXkpHZFlZqDNOwHJrlkh7sm7rIK1WWO8DpI2PVb1AXLtKlncR4p2LbB8i630kG%2b7LEEntIckTxUSXfStk%2bch3pMfI92X/7DU5%2b1vI3iIMvzPgSwkoBny//QbA8UNmYGBjylSDOpLei8UCGQO50m5H%2bq54uQCR0eZwOrHWm3sj3ZaqxgUYobTIheLS7ITaki1hUbfvMXOniHoL8Wgi6myEuzniwcZircOvDUSjjqA2scwMuLkFv9HZt2RNm1SH10zIYAOWPYdpS31b%2bPYsgUc5PIcqAV1XZfRZAo0wQJrgE4Be1Z104art0BEEaVASuDTIdbm5U5yBnG/f2SiPzOgWC9djD7mRHez260LRtdxVqqcY9oJnemYlZnPNlTyMEjIoZ1kRsLLCOuU38oolcyTNG75KAU6nd5bHgU2xYIIignjEMMh4Q5xtMY5HFEXFZHTYE8yapRIEK2g6XwJzCl2fcn68DsZj1qZq/bsEBFF9psFzY9bNL5yOb5jNfATeHONORxLaqDOi7too0xmGrQFvaaLb2OhKE%2buIWVtaCD0L11HDhrbbwsTQGHAcC/XG4N7ASKbVfHabnUEbE%2b3ORBhYqEr64Fvoad9SF0VTnjFR8J5qM4XrmthXGnU6ZwO7QkeZm%2bhrDatgCq%2bcIvv5iuSiIfuLjKg4avp9mSA%2bT7A6ctCvcNDUfv3xCr/V8GIt6PThrvDbCSk1RTGyvsYl/K0Nj0HkI43pdEqb9WGCkHRL97yYwMVcr7kO6EgycqaDfsj/ibnF7ElwBqYE2ZL/DYf0XhlYEjgJaDozaWfyibOUzLItzLgXO8N66i3qTXXepVyd5Tyb323lHsumPW1mK97lcbgGbNqoQf0suK8lVtFbTJSydR8lID9CrjjO7DgbDYvilfMETqEpuafktKml1nTVMEUmCC9FTplTGur8kj9UOu%2bc6DafHptPkPyU3MfksRe5rDXzvn7qdPNTp9Zf9E%2bbydezX84pe42z/hjG59C%2b7h/rp%2b1/tjSVozqmZL0AAAAASUVORK5CYII=' /%3e%3c/svg%3e\" width=\"1358\" data-srcset=\"/assets/static/ssh.82a2fbd.4bc5e83bb60782a5ec96cd0058699f72.png 480w, /assets/static/ssh.cbab2cf.4bc5e83bb60782a5ec96cd0058699f72.png 1024w, /assets/static/ssh.94dd11e.4bc5e83bb60782a5ec96cd0058699f72.png 1358w\" data-sizes=\"(max-width: 1358px) 100vw, 1358px\" data-src=\"/assets/static/ssh.94dd11e.4bc5e83bb60782a5ec96cd0058699f72.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/ssh.94dd11e.4bc5e83bb60782a5ec96cd0058699f72.png\" width=\"1358\"></noscript></p>\n<blockquote>\n<p>You might need to open port <code class=\"language-text\">2222</code> on your firewall (e.g. <code class=\"language-text\">ufw allow to any port 2222</code>).</p>\n</blockquote>\n<h4 id=\"client-set-up\"><a href=\"#client-set-up\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Client set-up</h4>\n<p>Copy the generated client key file from <code class=\"language-text\">~/eznode/ssh-keys/client_rsa</code> on the server to the client machine and setup an SSH tunnel:</p>\n<pre class=\"language-bash\"><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">)</span>$ <span class=\"token function\">ssh</span> -i ./client_rsa -fTN -L <span class=\"token number\">50001</span>:ez:50001 -p <span class=\"token number\">2222</span> root@mynode.com</pre>\n<p>You will now be able to access the remote Electrum server through <code class=\"language-text\">localhost:50001</code> on the client.</p>\n<blockquote>\n<p>Protip: Use <a href=\"https://medium.com/@gary4est/autossh-port-forwarding-23088d948787\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">autossh</code></a> to automatically restart dropped connections.</p>\n</blockquote>\n<h4 id=\"android-setup-with-connectbot\"><a href=\"#android-setup-with-connectbot\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Android setup with ConnectBot</h4>\n<details>\n <summary>Expand instructions...</summary>\n<p>You can setup an SSH tunnel from Android using the <a href=\"https://connectbot.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ConnectBot</a> app. Install it and:</p>\n<ol>\n<li>\n<p>Transfer the generated <code class=\"language-text\">client_rsa</code> private key file to your phone, open the app, tap <code class=\"language-text\">‚ãÆ</code> > <code class=\"language-text\">Manage Pubkeys</code> > :open_file_folder: and load the key. Long-tap it and select <code class=\"language-text\">Load</code> and <code class=\"language-text\">Load on start</code>.</p>\n<blockquote>\n<p>Alternatively, you can generate a key with ConnectBot and transfer the public key file to the server.</p>\n</blockquote>\n</li>\n<li>Go back to the main screen, tap <code class=\"language-text\">+</code> to add a new host, set the address to <code class=\"language-text\">root@mynodebox.com:2222</code>, untick <code class=\"language-text\">Start shell session</code>, tick <code class=\"language-text\">Stay connected</code> and save.</li>\n<li>Long-tap the host, tap <code class=\"language-text\">Edit port forwards</code>, tap <code class=\"language-text\">+</code>, set <code class=\"language-text\">Source port</code> to the local port to bind on the phone (e.g. <code class=\"language-text\">50001</code>) and <code class=\"language-text\">Destination</code> to <code class=\"language-text\">ez:&lt;port&gt;</code> (e.g. <code class=\"language-text\">ez:50001</code>).</li>\n<li>Tap the host to connect and verify the host's key fingerprint. Unfortunately, ConnectBot shows it in (the outdated and insecure) MD5, which you can get by setting <code class=\"language-text\">WEAK_SSH_CHECKSUM=1</code>.</li>\n</ol>\n<p>You should now be able to access the remote services through <code class=\"language-text\">localhost</code> on your phone.</p>\n<blockquote>\n<p>‚ö†Ô∏è Note that any app with the <code class=\"language-text\">INTERNET</code> permission will be able to access the local ports. To prevent malicious apps installed on your device from accessing the services, you'll need to enable authentication. BWT has <a href=\"https://github.com/bwt-dev/bwt/blob/master/doc/auth.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">experimental support for Electrum authentication</a> that could be used.</p>\n</blockquote>\n</details>\n<h4 id=\"punch-through-nats-with-a-reverse-ssh-tunnel\"><a href=\"#punch-through-nats-with-a-reverse-ssh-tunnel\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Punch through NATs with a reverse SSH tunnel</h4>\n<p>If you're unable to directly accept incoming connections to your server, you can create a reverse tunnel to route traffic through a different server that can.</p>\n<p>The server can be any cheap VPS. It doesn't need to run anything apart from an SSH server. It won't see anything apart from encrypted traffic and IP addresses. You will be safe from MITM attacks, as long as you verify the fingerprint the first time you connect.</p>\n<details>\n <summary>Expand instructions...</summary>\n<p>On the cheap VPS, edit <code class=\"language-text\">/etc/ssh/sshd_config</code>, add (assuming your username is <code class=\"language-text\">satoshi</code>):</p>\n<pre class=\"language-text\">Match User satoshi\n  GatewayPorts clientspecified</pre>\n<p>And reload the SSH server (e.g. <code class=\"language-text\">service ssh reload</code>).</p>\n<p>Then, on your eznode host, run:</p>\n<pre class=\"language-bash\"><span class=\"token function\">ssh</span> -fTN -R :2222:localhost:2222 satoshi@cheapvps.com</pre>\n<p>You will now be able to connect to the eznode SSH server through <code class=\"language-text\">cheapvps.com:2222</code>. You can setup SSH tunnels to the services through it in the same manner explained above.</p>\n<blockquote>\n<p><a href=\"https://localhost.run/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">localhost.run</a> offers tunneling as a service for $3.5/month (the free tier isn't suitable because its HTTP-only). It's used with the standard <code class=\"language-text\">ssh</code> client and doesn't require any special software installation. It supports custom domain names.</p>\n</blockquote>\n</details>\n<h4 id=\"options-1\"><a href=\"#options-1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Options</h4>\n<ul>\n<li><code class=\"language-text\">SSHD=0</code> (disabled by default, set to <code class=\"language-text\">1</code> or <code class=\"language-text\">UNRESTRICTED</code> to enable)</li>\n<li><code class=\"language-text\">SSHD_LOGS=0</code> (display dropbear's logs in the <code class=\"language-text\">docker run</code> output)</li>\n<li><code class=\"language-text\">DROPBEAR_OPTS=&lt;none&gt;</code> (custom CLI options for dropbear)</li>\n</ul>\n<h4 id=\"paths-1\"><a href=\"#paths-1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Paths</h4>\n<ul>\n<li><code class=\"language-text\">/root/id.pub</code> <code class=\"language-text\">/root/.ssh/authorized_keys</code> (mount from host to use existing client key)</li>\n<li><code class=\"language-text\">/data/ssh-keys/client_rsa</code> (generated client key)</li>\n<li><code class=\"language-text\">/data/ssh-keys/host_rsa</code> (generate host key)</li>\n</ul>\n<h4 id=\"ports\"><a href=\"#ports\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Ports</h4>\n<ul>\n<li><code class=\"language-text\">2222</code></li>\n</ul>\n<h2 id=\"nginx-ssl\"><a href=\"#nginx-ssl\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>NGINX SSL</h2>\n<p>NGINX-powered SSL terminating reverse proxy. Provides encryption, but not authentication. SSL relies on central authorities and is best avoided.</p>\n<p>To setup, set <code class=\"language-text\">SSL=1</code>, publish the SSL port and make sure to enable authentication:</p>\n<pre class=\"language-bash\">docker run -it -p <span class=\"token number\">443</span>:3443 <span class=\"token punctuation\">..</span>. eznode/eznode <span class=\"token assign-left variable\">SSL</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token assign-left variable\">AUTH_TOKEN</span><span class=\"token operator\">=</span>mySecretPassword</pre>\n<p>A private key and a self-signed certificate will be automatically generated and saved to <code class=\"language-text\">/data/ssl-keys/selfsigned.{key,cert}</code>. See <a href=\"#let-s-encrypt\"><em>Let's Encrypt</em></a> below for a CA-signed cert.</p>\n<p>The web services will be available on port <code class=\"language-text\">3443</code> under <code class=\"language-text\">/bwt/</code>, <code class=\"language-text\">/explorer/</code> and <code class=\"language-text\">/specter/</code>.</p>\n<p>The <em>unauthenticated</em> Electrum SSL server will be available on port <code class=\"language-text\">50002</code>. It should <em>not</em> be exposed directly to the Internet and is meant to be used behind an authentication layer like SSH or Tor.</p>\n<p>When <code class=\"language-text\">AUTH_TOKEN</code> is set, NGINX will be configured to authenticate the password before forwarding traffic to the backend web services. This helps protect against zero-day exploits.</p>\n<h4 id=\"options-2\"><a href=\"#options-2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Options</h4>\n<ul>\n<li><code class=\"language-text\">SSL=0</code> (disabled by default, set to <code class=\"language-text\">1</code> to enable)</li>\n<li><code class=\"language-text\">AUTH_TOKEN=&lt;none&gt;</code> (setup <code class=\"language-text\">htpasswd</code>-based login enforced by nginx)</li>\n</ul>\n<h4 id=\"paths-2\"><a href=\"#paths-2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Paths</h4>\n<ul>\n<li><code class=\"language-text\">/data/ssl-keys/selfsigned.{key,cert}</code> (keys and certificates)</li>\n</ul>\n<h4 id=\"ports-1\"><a href=\"#ports-1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Ports</h4>\n<ul>\n<li><code class=\"language-text\">3443</code> (HTTPS)</li>\n<li><code class=\"language-text\">50002</code> (Electrum RPC)</li>\n</ul>\n<h2 id=\"let-s-encrypt\"><a href=\"#let-s-encrypt\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Let's Encrypt</h2>\n<p>To obtain a CA-signed certificate from Let's Encrypt, set <code class=\"language-text\">SSL=1 SSL_DOMAIN=&lt;domain&gt;</code> and publish the HTTP/S ports for remote access, like so:</p>\n<pre class=\"language-bash\">docker run -it -p <span class=\"token number\">443</span>:3443 -p <span class=\"token number\">80</span>:8080 <span class=\"token punctuation\">..</span>. eznode/eznode <span class=\"token assign-left variable\">SSL</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token assign-left variable\">SSL_DOMAIN</span><span class=\"token operator\">=</span>mynodebox.com</pre>\n<blockquote>\n<p>You might need to open the HTTP/S ports on your firewall (e.g. <code class=\"language-text\">ufw allow to any port 80,443</code>).</p>\n</blockquote>\n<h4 id=\"with-existing-webserver\"><a href=\"#with-existing-webserver\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>With existing webserver</h4>\n<details>\n <summary>Expand instructions...</summary>\n<p>Verifying domain ownership for the Let's Encrypt certificate requires accepting connections on port <code class=\"language-text\">80</code>. If you already have a webserver occupying this port, you can configure it to forward verification requests on a subdomain to the ez webserver. Example with NGINX:</p>\n<pre class=\"language-text\">server {\n    listen 80;\n    server_name ez.mynodebox.com;\n    location /.well-known/acme-challenge/ { proxy_pass http://localhost:8080; }\n}</pre>\n<p>Then start docker with <code class=\"language-text\">-p 3443:3443 -p 127.0.0.1:8080:8080</code> and access the SSL server through <code class=\"language-text\">https://ez.mynodebox.com:3443/</code>.</p>\n</details>\n<h4 id=\"options-3\"><a href=\"#options-3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Options</h4>\n<ul>\n<li><code class=\"language-text\">SSL_DOMAIN=&lt;none&gt;</code> (obtain CA-signed certificate for the given domain)</li>\n<li><code class=\"language-text\">LETSENCRYPT_EMAIL=&lt;none&gt;</code> (for renewal and security notices, optional)</li>\n<li><code class=\"language-text\">LETSENCRYPT_LOGS=0</code> (display letsencrypt‚Äôs logs in the <code class=\"language-text\">docker run</code> output)</li>\n</ul>\n<h4 id=\"paths-3\"><a href=\"#paths-3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Paths</h4>\n<ul>\n<li><code class=\"language-text\">/data/ssl-keys/letsencrypt</code> (keys and certificates)</li>\n</ul>\n<h4 id=\"ports-2\"><a href=\"#ports-2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Ports</h4>\n<ul>\n<li><code class=\"language-text\">8080</code> (HTTP, for domain verification)</li>\n</ul>\n"}},"context":{}}